<?php

/**
 * @file
 * Main file for the Mortagage Misc module, which containg logics for form and node alter.
 * 
 * @ingroup mortgage_misc
 */


function mortgage_misc_menu() {
  $items['welcome'] = array(
	  'title' => t('Welcome'),
		'description' => 'Welcome Page',
		'type' => MENU_NORMAL_ITEM,
		'page callback' => 'mortgagespeak_welcome',
		'access arguments' => array('access content'),
  );
  $items['my-page/%'] = array(
	  'title' => t('My Page'),
		'description' => 'My Page',
		'page arguments' => array(1),
		'page callback' => 'mortgagespeak_my_page',
		'access arguments' => array('access content'),
	);

  return $items;
}

function mortgagespeak_my_page(){
	global $user;
	$output = 'comes';
	return $output;
}

function mortgagespeak_welcome(){
	global $user;
	$output = '';
	return $output;
}

function mortgage_misc_form_alter(&$form, &$form_state, $form_id) {
 	if($form_id == 'user_register_form'){
		$form['select_all'] = array(
	    '#type' => 'checkbox',
	    '#title' => t('Select All'),
  	);
 		$form['actions']['submit']['#value'] = 'Register';
 	}
}
function mortgage_misc_form_views_exposed_form_alter(&$form, $form_state, $form_id) {
	global $user;
	$user_topics = '';
	$user_info = user_load($user->uid);
	$cnt = 1;
	if($form['#id'] == 'views-exposed-form-tracked-news-page'){
		$user_news = array('All'=>'All Tracked News');
		if(isset($user_info->field_news_topics[LANGUAGE_NONE]) && !empty($user_info->field_news_topics[LANGUAGE_NONE])){
			foreach($user_info->field_news_topics[LANGUAGE_NONE] as $tidKey=>$tidVal){
				$user_topics = taxonomy_term_load($tidVal['tid']);
				$user_news[$cnt] = $user_topics->name;
				$cnt++;
			}   
		}
		$form['field_alpha_news_topics_tid_1']['#options'] = $user_news;
		$form['field_alpha_news_topics_tid_1']['#value'] = 'All';   	
  }

  if($form['#id'] == 'views-exposed-form-tracked-companies-page'){
  	$user_company = array('All'=>'All Tracked News');
  	if(isset($user_info->field_company_tags[LANGUAGE_NONE]) && !empty($user_info->field_company_tags[LANGUAGE_NONE])){
			foreach($user_info->field_company_tags[LANGUAGE_NONE] as $tidKey=>$tidVal){
				$user_tags = taxonomy_term_load($tidVal['tid']);
				$user_company[$cnt] = $user_tags->name;
				$cnt++;
			}   
		}
		$form['company_tag']['#options'] = $user_company;
		$form['company_tag']['#value'] = 'All';
		$form['company_tag1']['#options'] = $user_company;
		$form['company_tag1']['#value'] = 'All';
  }
  
}